<!DOCTYPE html>
<html>

<head>
    <title>Compass</title>
    <meta charset="utf-8">
    <meta name="viewport" content='width=device-width, initial-scale=1'>
    <link rel="stylesheet" type="text/css" href="assets/css/normalize.css">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <style>
    .brand-logo {
        height: 1.5em;
        width: 1.5em;
        margin: .25em .15em;
    }
    </style>
</head>

<body>
    <nav>
        <div class="nav-wrapper">
            <a href="#!" class="brand-logo"><img src='assets/img/safari.svg'></a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
            <ul class="right hide-on-med-and-down">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="program-selection.html">Programs</a></li>
                <li><a href="feedbck.html">Feedback</a></li>
            </ul>
            <ul class="side-nav" id="mobile-demo">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="program-selection.html">Programs</a></li>
                <li><a href="feedback.html">Feedback</a></li>
            </ul>
        </div>
    </nav>
    <header id="masthead">
        <div class="container">
            <h1>Am I eligible for WIC Benefits? </h1>
        </div>
    </header>
    <div class="container content">
        <div class="main-section">
            <section class="data">
                <div class="panel panel-default panel-primary">
                    <div class="panel-heading">Answer these questions to Determine Eligibility for WIC Benefits!</div>
                    <div class="panel-body">
                        <form>
                            <div class="form-group">
                                <label for="zip">Enter Zip code</label>
                                <input type="number" class="form-control" id="zip" placeholder="e.g. 94110">
                            </div>
                            <label>Does at least one of the following describe someone in your household: 1) is pregnant 2) has had a baby (or been pregnant) within the last 6 months 3) is currently breastfeeding a baby that is less than 12 months old 4) is a baby, child or foster child under the age of 5? </label>
                            <select class="browser-default" id="pregnancy">
                                <option value="0" disabled selected>Choose your option</option>
                                <option value='1'>Yes</option>
                                <option value='2'>No</option>
                            </select>
                            <div class="form-group">
                                <label for="household">Household size (excluding member that is age 60+, or is disabled)</label>
                                <input type="number" class="form-control" id="household" placeholder="e.g. 3">
                            </div>
                            <div class="form-group">
                                <label for="income">Monthly income (including social security) in dollars $</label>
                                <input type="number" class="form-control" id="income" placeholder="e.g. 1287">
                            </div>
                            <button class="btn waves-effect waves-light" id="submitForm" type="submit" name="action">Submit<i class="material-icons right">send</i></button>
                        </form>
                    </div>
                </div>
        </div>
    </div>
    <footer id="footer" class="site-footer">
        <div class="container">
            &copy; Copyright 2017 COMPASS
        </div>
    </footer>
    <script src="https://www.gstatic.com/firebasejs/3.7.1/firebase.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js"></script>
    <script type="text/javascript">
    // Initialize Firebase
    $(document).ready(function() {

        var config = {
            apiKey: "AIzaSyDkStdhgEH45RGotVbSO6CakBFFYppiGLs",
            authDomain: "cal-compass.firebaseapp.com",
            databaseURL: "https://cal-compass.firebaseio.com",
            storageBucket: "cal-compass.appspot.com",
            messagingSenderId: "888186000127"
        };

        firebase.initializeApp(config);
        var rootRef = firebase.database().ref();
        var updates = {};

        //$('select').material_select();
        // provides nav bar with functionality
        $(".button-collapse").sideNav();

        // this button directs them to the WIC Map, along with the eligibility results
        $('#submitForm').click(function(event) {
            event.preventDefault();
            firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                    console.log(user.displayName, "is logged in");
                    // User is signed in.
                    // add deets to updates obj
                    updates['/users/' + user.uid + '/zipcode/'] = $('#zip').val().trim();
                    // write updates
                    rootRef.update(updates);
                    // off to maps 
                    // window.location = "mapFS.html";
                } else {
                    console.log('No user is signed in.');
                }
            });
            var pregnancyCheck = $('#pregnancy').val();
            //console.log(pregnancyCheck)
            var householdCheck = $('#household').val();
            var incomeCheck = $('#income').val();

            var incomeArray = [0, 1832, 2470, 3108, 3747, 4385, 5023, 5663, 6304];
            if (pregnancyCheck === '1' && householdCheck > 8 && (incomeCheck <= (6304 + (householdCheck - 8) * 642))) {
                window.location = 'mapWIC.html';
            } else if (pregnancyCheck === '1' && householdCheck <= 8 && (incomeCheck <= incomeArray[householdCheck])) {
                window.location = "mapWIC.html";
                // } else if (pregnancyCheck !== '0') {
                // window.location = "https://getcalfresh.org/";
            };

        });

    });
    </script>
    <!-- <div><p>Based on your responses, you may be eligible for WIC benefits!
    Our Prescreening Tool does not guarantee that you will be eligible for benefits. Contact the WIC State or local agency serving your area to schedule an appointment. You must apply for benefits at your WIC local agency. 

    Documentation List
    You will need to bring several documents to your WIC appointment. Please ask your WIC local agency which documents are required. Click on the documentation types below to see examples.
    Proof of Current Benefits Enrollment
    Proof of Identity (Woman)
    Proof of Identity (Child/Infant)
    Proof of Residency
    Proof of Pregnancy</p></div>

    <script type="text/javascript">
        //Supplemental Nutrition Assistance Program (SNAP)/Food Stamps/CalFresh Eligibility
        //Enter Zip code
        //is there at least one person is age 60 or older, or is disabled in household?
        //household size (excluding members that is age 60+, or is disabled)
        //monthly income (including social security)
        //Submit - when clicked, link to certain forms
        $(document).ready(function() {
        $('select').material_select();
        });
        //
    </script>-->
</body>

</html>
